<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>My History - FitTrack</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/entries.css" />
  <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;600;800&display=swap" rel="stylesheet" />
</head>
<body>
  <header>
    <nav class="navbar navbar-expand-lg custom-navbar">
      <section class="container d-flex justify-content-between align-items-center">
        <a href="index.html" class="navbar-brand d-flex align-items-center">
          <img src="images/fittrack_logo_darkgreen.png" alt="FitTrack Logo" width="64" height="64" class="me-2">
          <strong class="fs-4 text-dark">FitTrack</strong>
        </a>
        <nav class="d-flex align-items-center gap-3">
          <ul class="nav mb-0">
            <li class="nav-item"><a href="index.html" class="nav-link">Home</a></li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle active-link" href="#" id="entryDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                View History
              </a>
              <ul class="dropdown-menu" aria-labelledby="entryDropdown">
                <li><a class="dropdown-item" href="dashboard.html">Main Dashboard</a></li>
                <li><a class="dropdown-item" href="addentry.html">Add Entry</a></li>
                <li><a class="dropdown-item" href="entrydetails.html">Calories</a></li>
                <li><a class="dropdown-item" href="feedback.html">Feedback</a></li>
                <li><a class="dropdown-item" href="traineeprofile.html">Profile</a></li>
              </ul>
            </li>
            <li class="nav-item"><a href="logout.html" class="btn btn-success px-4 ms-2">Logout</a></li>
          </ul>
        </nav>
      </section>
    </nav>
  </header>

  <main class="container my-5">
    <h2 class="form-title text-center fw-bold mb-4 d-flex justify-content-center align-items-center gap-3">
      <img src="images/healthy_nutrition_icon.png" alt="History Icon" style="height: 2.2em;">
      My History
    </h2>
    <section class="history-section">
      <table class="history-table table table-bordered table-hover">
        <thead class="table-light">
          <tr>
            <th>Date</th>
            <th>Time</th>
            <th>Meals</th>
            <th>Workout</th>
            <th>Calories</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="entriesTable">
          <tr><td colspan="6">Loading...</td></tr>
        </tbody>
      </table>
    </section>
  </main>

  <dialog id="editModal">
    <form method="dialog" id="editForm">
      <h3>Edit Entry</h3>
      <label for="editTime" class="form-label">Time:
        <input type="time" id="editTime" class="form-control" />
      </label>

      <label for="editWorkout" class="form-label mt-3">Workout:
        <select id="editWorkout" name="editWorkout" class="form-select" required>
          <option value="" disabled selected>Select a workout</option>
        </select>
        <div id="edit-workout-error" class="invalid-feedback d-block"></div>
      </label>

      <label for="editMealGroup" class="form-label mt-3">Meals:</label>
      <section id="editMealGroup" class="mb-3"></section>
      <button type="button" id="addEditMealBtn" class="btn btn-outline-secondary mb-3">+ Add Meal</button>
      <section style="margin-top: 16px;" class="d-flex justify-content-end gap-2 button-row">
        <button type="submit" class="btn btn-success">Save</button>
        <button type="button" class="btn btn-secondary" onclick="document.getElementById('editModal').close()">Cancel</button>
      </section>
    </form>
  </dialog>

  <dialog id="deleteConfirmModal">
    <form method="dialog" id="deleteConfirmForm">
      <h4 style="color: #14532D;">Are you sure you want to delete this entry?</h4>
      <section style="margin-top: 16px; display: flex; justify-content: flex-end; gap: 12px;">
        <button type="submit" id="confirmDeleteBtn" class="btn btn-danger">Yes, Delete</button>
        <button type="button" class="btn btn-secondary" onclick="document.getElementById('deleteConfirmModal').close()">Cancel</button>
      </section>
      <!-- ✅ כאן תופיע הודעת הצלחה/שגיאה -->
      <div id="deleteFeedbackArea" class="mt-3"></div>
    </form>
  </dialog>

  <footer id="contact" class="footer-section text-center text-white mt-5 py-4">
    <section class="mb-3">
      <a href="https://facebook.com" target="_blank"><img src="images/facebook.svg" alt="Facebook" width="24" class="mx-2 social-icon" /></a>
      <a href="https://instagram.com" target="_blank"><img src="images/instagram.svg" alt="Instagram" width="24" class="mx-2 social-icon" /></a>
      <a href="https://twitter.com" target="_blank"><img src="images/twitter.svg" alt="Twitter" width="24" class="mx-2 social-icon" /></a>
    </section>
    <small>© 2025 FitTrack, All rights reserved.</small>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/config.js" type="module"></script>
  <script src="js/entries.js" type="module"></script>
</body>
</html>